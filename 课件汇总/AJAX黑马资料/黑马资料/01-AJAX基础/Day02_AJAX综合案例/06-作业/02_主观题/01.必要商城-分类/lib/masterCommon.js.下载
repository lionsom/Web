var masterGuy={categoryBarScroll:function(){var o=!1;return function(n,t,e,r){var a=$(".nav"),c=!1;o||(o=!0,n&&$(window).on("scroll",function(){$("body").scrollTop()>=n||document.documentElement.scrollTop>=n?c||(c=!0,a.addClass("retract").animate({top:0},200),$(".nav-search ul").hide(),e&&e()):(0!=$("body").scrollTop()&&$("body").scrollTop()<=t||0!=document.documentElement.scrollTop&&document.documentElement.scrollTop<=t||0==$("body").scrollTop()&&0==document.documentElement.scrollTop)&&c&&(c=!1,a.stop().removeAttr("style").removeClass("retract"),$(".nav-search ul").show(),r&&r())}))}}(),categoryWidth:function(){for(var o=$(".nav-main>ul"),n=0;n<o.length;n++)o.eq(n).find(".nav-sub").last().addClass("nav-lastSub")},setData:function(o,n){var t=$('<img class="none" src="" />'),e=setTimeout(function(){r=!1,n()},500),r=!0;t.on("load",function(){clearTimeout(e),r&&n()}).on("error",function(){clearTimeout(e),r&&n()}).attr("src",o),$("body").append(t)},randomStr:function(o){o=o||36;for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",e=0;o>e;e++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},assemblyParam:function(o){var n="https://trace.biyao.com/by.gif",t=n+"?",e=function(){return $.cookie("uuid")||masterGuy.randomStr(36)},r=function(){return $.cookie("uid")||""},a=function(){return"3-"+(new Date).getTime()+"-"+cipher(c.uu).substring(0,16)},c={pf:"pc",uu:e(),u:r(),av:"",d:"",osv:"",dw:window.screen.width,dh:window.screen.height},i={lt:"pc-ub",lv:"1.0",ubid:a(),pclk:"",pclkp:"",pn:"",pnp:""},s="";for(var l in c)c.hasOwnProperty(l)&&(t+=l+"="+encodeURIComponent(c[l])+"&");for(var u=0;u<o.length;u++){for(var d in o[u])o[u].hasOwnProperty(d)&&(i[d]=o[u][d]);for(var h in i)i.hasOwnProperty(h)&&(s+=h+"="+encodeURIComponent(i[h])+"&");s=s.slice(0,-1),s+="||"}return s=s.slice(0,-2),t+="body="+encodeURIComponent(s)},getHotWord:function(){var o,n=$(".nav-search"),t=this;$.ajax({url:window.ControllerSite+"/classify/hotWord",data:"",dataType:"jsonp",jsonp:"callback",success:function(e){if(e.success){for(var r=0;r<e.data.hotwords.length&&10>r;r++)o=$("<li>"+(e.data.hotwords[r].length<=10?e.data.hotwords[r]:e.data.hotwords[r].slice(0,10)+"...")+"</li>"),o.click(function(o,e){return function(){var r={pclk:"search_req.hotword",pclkp:"pos="+encodeURIComponent(e)+"&w="+encodeURIComponent(o),pn:"search_show",pnp:"q="+encodeURIComponent(o)};n.find("input").val(o),t.search(null,r)}}(e.data.hotwords[r],r)).appendTo(n.find("ul"));n.find("input").attr("placeholder",e.data.defaultWord).on("focus",function(){$(".retract").length>0&&n.find("ul").show()}).on("blur",function(){$(".retract").length>0&&setTimeout(function(){n.find("ul").hide()},200)})}}})},search:function(o,n){var t,e=$.trim($("#searchInput").val()),r=[];e&&(r.push({pclk:"home.search",pclkp:"",pn:"search_req",pnp:""}),n&&r.push(n),t=masterGuy.assemblyParam(r),masterGuy.setData(t,function(){window.location.href=window.ControllerSite+"/classify/search.html?query="+encodeURIComponent(encodeURIComponent(e))}))},backBar:function(){$(window).on("scroll",function(){$("body").scrollTop()>0||document.documentElement.scrollTop>0?$(".rightBar-top").fadeIn():$(".rightBar-top").fadeOut()}),$(".rightBar-top").on("click",function(){$("body, html").animate({scrollTop:0},500)})},rightBarPos:function(o){$(".rightBar").css("margin-left",o+"px")},init:function(){var o=this;this.categoryWidth(),this.backBar(),$(".rightBar").show(),this.categoryBarScroll(130,65),/(account)/.test(location.pathname)||masterGuy.getHotWord(),$("#searchBtn").click(o.search),$("#searchInput").on("keydown",function(n){13==n.keyCode&&o.search()})}};$(function(){masterGuy.init()});