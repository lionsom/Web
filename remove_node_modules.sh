#!/bin/bash

# 检查是否提供了路径参数
if [ $# -eq 0 ]; then
    echo "请提供要删除 node_modules 的路径"
    echo "用法: $0 <路径>"
    exit 1
fi

# 获取目标路径
target_path="$1"

# 检查路径是否存在
if [ ! -d "$target_path" ]; then
    echo "错误: 路径 '$target_path' 不存在"
    exit 1
fi

# 计数器
deleted_count=0

# 递归查找并删除 node_modules 文件夹
find "$target_path" -type d -name "node_modules" | while read -r dir; do
    echo "正在删除: $dir"
    rm -rf "$dir"
    if [ $? -eq 0 ]; then
        ((deleted_count++))
        echo "成功删除: $dir"
    else
        echo "删除失败: $dir"
    fi
done

echo "总共删除了 $deleted_count 个 node_modules 文件夹"
